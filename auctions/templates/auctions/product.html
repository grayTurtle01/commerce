{% extends 'auctions/layout.html' %}

{% block body %}




 <div class="row">
    <div class="col-lg-4 m-3">
    <div>
            
      {% if messageFail %}
       <div class="alert alert-danger col-lg-9 mt-3">{{messageFail}}</div>
      {% endif %}
      
      {% if messageSuccess %}
      <div class="alert alert-success col-lg-11 mt-3">{{messageSuccess}}</div>
      {% endif %}
      


      <h1> {{ product.name }}</h1>

      {% if user.is_authenticated %}
      <a href="{% url 'add_book_watchlist' product.id %}">
        <span class="badge bg-secondary text-white mb-3">
          {% if is_selected %}
            Remove from WatchList
          {% else %}
            Add to WatchList
          {% endif %}
        </span>
      </a>
      {% endif %}

    </div>

    <img src="{{ product.image_url }}" style="width:50%">
    <p>{{ product.description  }}</p>
    <h2>Price: ${{ product.price }}</h2>


    {% if product.is_active %}  
       {% if user.is_authenticated %}  

      <form action="{% url 'show_product' product.id %}" method="POST">
        {% csrf_token %}
        {{ form.new_price }}
        <input type="submit" value="Place Bid" class="btn btn-primary">
      </form>
      {% endif %}
      
      {% if product.creator == user.username %}
        <a href="{% url 'close_bid' product.id %}" class="btn btn-dark m-3">Close Bid</a>  
      {% endif %} 
      
      {% else %}
      <div class="alert alert-secondary col-lg-9 ">Closed Bid.  Winner: {{product.winner}}</div>
      
      
      {% endif %}
      

      
      
      <h2>Details</h2>
      <ul>
        <li>Listed by: <a href="{% url 'show_profile' product.creator %}">{{product.creator}}</a></li>
        <li>Category: {{product.category}}</li>
        <li>Status: {% if product.is_active %}
          Active
          {% else %}
          Closed
          {% endif %}
        </li>
      </ul>
      
    </div>

    <div class="col-lg-4 m-3">
      <h2>Comments</h2>
      <ul>
          {% for comment in comments %}
            <li>{{comment}}</li>
          {% empty %}
            <li>No commets yet</li>  
          {% endfor%}
        </ul>

      {% if user.is_authenticated %}  
        <form action="{% url 'add_comment' product.id %}" method="post">
          {% csrf_token%}
          <textarea name="comment" id="" cols="30" rows="3" required></textarea>
          <input type="submit" value="Send Comment" class="btn btn-info">
        </form>
      {% endif %}  

    </div>
 </div>


{% endblock%}